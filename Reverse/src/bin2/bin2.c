#define _GNU_SOURCE
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc, char **argv) {

	// "strcmp_funct10n_kn0ws_n0th1ng_4b0ut_pr1v4cy"
	unsigned char password[44] = {
		0x59, 0x5e, 0x58, 0x49, 0x47, 0x5a, 0x75, 0x4c, 0x5f, 0x44, 0x49, 
		0x5e, 0x1b, 0x1a, 0x44, 0x75, 0x41, 0x44, 0x1a, 0x5d, 0x59, 0x75, 
		0x44, 0x1a, 0x5e, 0x42, 0x1b, 0x44, 0x4d, 0x75, 0x1e, 0x48, 0x1a, 
		0x5f, 0x5e, 0x75, 0x5a, 0x58, 0x1b, 0x5c, 0x1e, 0x49, 0x53, 0x00
	};

	if (argc < 2) {
		printf("Usage : %s password\n", argv[0]);
		exit(0);
	}

	if (strcmp(argv[1], memfrob(password, strlen(password))) == 0) {
		printf("UQAM{%s}\n", argv[1]);
	} else {
		puts("You're not allowed in here !");
	}

	return 0;
}
