perlmaster : I messed up last time, we should use this updated version now

import struct
import random

def padding(value, N):
    bytes_value    = hex(value)[2:].replace("L", "").decode("hex")
    nb_bytes_N     = len(hex(N)[2:].replace("L", "")) / 2 - 1
    nb_bytes_value = len(bytes_value)
    remaining = nb_bytes_N - nb_bytes_value - 5
    final = struct.pack("<I", remaining) + "\x80" + remaining * "\x00" + bytes_value
    return int(final.encode("hex"), 16)

def unpad(value):
    hexa = hex(value)[2:].replace("L", "")
    if len(hexa) % 2 == 1:
        hexa = "0" + hexa
    padded = hexa.decode("hex")

    if len(padded) < 6:
        print("Unexcepted size of %d." % len(padded))
        return None

    length = struct.unpack("<I", padded[:4])[0]
    magic = padded[4]

    if magic != "\x80":
        print("Invalid padding expected 0x80 got %s" % hex(ord(magic)))
        return None

    return padded[5 + length:]

def probably_prime(n, k):
    if n < 2: return False
    for p in [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31]:
        if n < p * p: return True
        if n % p == 0: return False
    r, s = 0, n - 1
    while s % 2 == 0:
        r += 1
        s //= 2
    for _ in range(k):
        a = random.randrange(2, n - 1)
        x = pow(a, s, n)
        if x == 1 or x == n - 1:
            continue
        for _ in range(r - 1):
            x = pow(x, 2, n)
            if x == n - 1:
                break
        else:
            return False
    return True

def getPrime(size):
    p = 10

    while not probably_prime(p, 50):
        p = random.randrange(1, 2**size)

    return p

def encrypt(message):
    p = getPrime(512)
    q = getPrime(512)
    N = p * q
    e = 5

    message = int(message.encode("hex"), 16)
    padded = padding(message, 2**500)
    result = pow(padded, e, N)

    return str(result) + "," + str(N)

message = raw_input("Enter your message to encrypt : ")
encrypted = encrypt(message)
print("***SECRET***%s***SECRET***" % encrypted)

yoda : ALERT ! ***SECRET***2791616455154298429897608653873637469399839740621380920740738786414218121577920976641648322200652360205613029018211425863647187554074248420615890842664322613610508634461939692879955534984906748173922196574615672319106109527367983625858100738906733487322795944565239197709536776236397301253295607425918217911,9154639923734212752830010265783366698667663739742722164494144599999468764024202047043232362399236907169815886071288175236789139574904021919944191737933423277842211937539702175721796337719189666182342738005436046020553162633362600077400367132723745740288898316880255096179064597934816048852439120256033283387***SECRET***
yoda : ALERT !! ***SECRET***33002071334947088812503173346986908819905175285524450389185267419619039941371858707939395861606762271147135529332788865666698908649824033724957022590904910063459659830780042630072902813279350014512966892906106345061344826426667835286995605946249052702587194970820190941267018756863911196308482631552620677276,88444879312631851689754226107618898681415916750684468144655972651799140531251581858890064159554346097283225917421430778554675677797233844990571084770365872435661713546997818051997394629575472753655495572594045182587876276784952844570415176975692690729895946251473813263898027935405714070443010130571255193973***SECRET***
yoda : ALERT !!! ***SECRET***10810583396481111381570652569568621220701075373209349448577111090906511289850694811512781875420637536052349793198949715251434242701065377801447363135515337362020409927566075744964994692702195559629580603016697364695675099950200106503738538790641163255502419343861762192073901144215284167657966361005123673164,16372164912895164138333890757771433086926716658013192494644163756147608096050716045684968960036899991296657565431308237634292344878034383359840744316323996207491749159894317837331099471525342307095638247283102444848158241267289705183231569277493557474742840385810786347615305956207124893803409072020779793537***SECRET***
yoda : ALERT !!!! ***SECRET***38995483912288264714468209852311562297851814826761212876368274130917646206308443770109178729615636122275579516315156127067588290865321114498920510378148495249372928424556139530193481064841697345517990202736545086648731804148183748567445941060995570867823847616684248612307290026395743916612361322629085117715,75919449979388703017058328091175483547908607147298543800388524689144593702172059540479575181083120530637993573491201326316030450174021200959659700474891616128177558227228625684052266098774580031431649289750348066649443280954455703913817525697490442195724710292157808151251896384277894523322082705645327983157***SECRET***
yoda : ALERT !!!!! ***SECRET***135166324116797758025534244132599286468350641949865171481141033149688437509367544306877209388638559221709011991090308738905815762937693153859556631934648973975804634269991508169669336438754308927251127497514341486254597117685515911523147799249083603564092452631176630443504142522488436999627031288110078411910,142407288616636595377277431752529145658784497459999942796754548159847233808923405298572370572288267337136664196156983683631254132001330895025996493123765357558399306540161006558545949220368912095628683694761928439028353281476708204596903057289511857585041923555602218672754794323819784285974068263395656950657***SECRET***
yoda : I repeat one last time ! ***SECRET***33955217679613545697134058998832161439437000014488195646793938377620969969981051951124989611117114312301681486939451821726554061895117926672907810666699809173151061496831414475792236861908985536129237415662606836762283883644644624119873135067965230437065844371909182354794615030331537406335817835392998069654,42879696852772700910669596722072857251830903661728105721032029789753402936805588757709888923090187621023271382432993885549327063651219044110718050558439849431480313145535718217742560541677126882774099520701611892416504117447435409721705797810838256916102969198523048685733274374721639625955427908715967221599***SECRET***